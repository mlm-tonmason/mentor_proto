syntax = "proto3";

package mentor.client.bot;

import "mentor/types/bot.proto";
import "mentor/types/common.proto";

message ListBotsRequest {
  mentor.types.PageRequest pagination = 1;

  // Filters
  string search_query = 2; // Not used in Workshop but maybe useful
  
  mentor.types.bot.BotGenre genre = 3; // TWIN or EXPERT
  
  string category_tag = 4; // e.g. "Business"
  
  bool is_hot = 5;
  bool is_favorite = 6;
  bool is_subscribed = 7;

  // Sorting
  enum Sort {
    SORT_UNSPECIFIED = 0;
    SORT_NEWEST = 1;
    SORT_POPULAR = 2; // Subscribers count
    SORT_TOP_RATED = 3; // Rating
  }
  Sort sort = 8;
  mentor.types.SortOrder sort_order = 9;
}

message ListBotsResponse {
  repeated mentor.types.bot.Bot bots = 1;
  mentor.types.PageResponse pagination = 2;
}

message GetBotRequest {
  uint32 bot_id = 1;
}

message ToggleBotFavoriteRequest {
  uint32 bot_id = 1;
}

message ToggleBotFavoriteResponse {
  bool is_favorite = 1; // New state
}

message RateBotRequest {
  uint32 bot_id = 1;
  uint32 score = 2; // 1-5
}

message RateBotResponse {
  bool success = 1;
  mentor.types.bot.BotRatingStats new_rating_stats = 2; // Updated stats
}

service BotService {
  rpc ListBots(ListBotsRequest) returns (ListBotsResponse);
  rpc GetBot(GetBotRequest) returns (mentor.types.bot.Bot);
  
  rpc ToggleBotFavorite(ToggleBotFavoriteRequest) returns (ToggleBotFavoriteResponse);
  rpc RateBot(RateBotRequest) returns (RateBotResponse);
}
