syntax = "proto3";

package mentor.client.memory;

import "mentor/types/memory.proto";
import "google/protobuf/struct.proto";

message GetMemoryRequest {
  uint32 bot_id = 1;
}

message UpdateMemoryRequest {
  uint32 bot_id = 1;
  google.protobuf.Struct data = 2; // Merge or Replace? Usually merge.
}

message GetKVMemoryRequest {
  uint32 bot_id = 1;
}

message UpdateKVMemoryRequest {
  uint32 bot_id = 1;
  map<string, string> items = 2; // Keys to update
}

service MemoryService {
  // Read/Write Structured Facts
  rpc GetMemory(GetMemoryRequest) returns (mentor.types.memory.AvatarUserMemory);
  rpc UpdateMemory(UpdateMemoryRequest) returns (mentor.types.memory.AvatarUserMemory);

  // Read/Write Flat KV Settings
  rpc GetKVMemory(GetKVMemoryRequest) returns (mentor.types.memory.AvatarUserKVMemory);
  rpc UpdateKVMemory(UpdateKVMemoryRequest) returns (mentor.types.memory.AvatarUserKVMemory);
}
