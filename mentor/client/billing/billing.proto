syntax = "proto3";

package mentor.client.billing;

import "mentor/types/billing.proto";
import "mentor/types/common.proto";
import "google/protobuf/empty.proto";

// Сервис Биллинга (Клиентский API).
service BillingService {
  // Получить дашборд подписок (Суммы, Балансы, Активные подписки).
  rpc GetSubscriptionDashboard(google.protobuf.Empty) returns (mentor.types.billing.SubscriptionDashboardData);

  // Приобрести подписку на бота (или сменить тариф).
  // По глобальному ID тарифного плана система определяет автора и проверяет текущую подписку пользователя.
  // Если подписка уже есть, происходит Upgrade/Downgrade или продление.
  // Если нет — создается новая подписка.
  rpc PurchaseBotSubscription(mentor.types.billing.BotTariffPlan.Id) returns (mentor.types.billing.BotSubscription);

  // Получить детали конкретной транзакции.
  rpc GetTransaction(mentor.types.billing.Transaction.Id) returns (mentor.types.billing.Transaction);

  // Получить историю транзакций (Пополнения, Списания, Награды) с курсорной пагинацией.
  // Для первой страницы передать Cursor с last_id = 0 (или null).
  // Для следующих страниц передать last_id последней полученной транзакции.
  // По умолчанию сортировка ASC (от старых к новым), можно изменить в Cursor.sort_order.
  rpc GetTransactions(mentor.types.Cursor) returns (mentor.types.billing.Transaction.List);
}
