# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏ –ß–∞—Ç (Library & Active Chat)

## 1. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ß–∞—Ç–∞ (Split View)
–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω–∞—è –Ω–∞ —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (Sidebar) –∏ —Å–∞–º —á–∞—Ç.

![Chat Screen](./assets/chat_in_library.png)

### –ë–ª–æ–∫: Sidebar (–°–ø–∏—Å–æ–∫ –ö–æ–Ω—Ç–∞–∫—Ç–æ–≤)
* **API –ú–µ—Ç–æ–¥**: `ChatService/ListContactBots`.
* **–ú–æ–¥–µ–ª—å**: `ListContactBotsResponse.Contact` (–ë–æ—Ç + –ê–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã).
* **–õ–æ–≥–∏–∫–∞ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**:
    1.  **–ö–æ–Ω—Ç–∞–∫—Ç—ã (–ë–æ—Ç—ã)**:
        *   –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –±–æ—Ç—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –µ—Å—Ç—å –¥–∏–∞–ª–æ–≥–∏ –∏–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞.
        *   –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö **–ß–∞—Ç–æ–≤** (`chat_threads`).
    2.  **Pinning (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ë–æ—Ç–æ–≤)**:
        *   **–ò–∫–æ–Ω–∫–∞**: –°–∫—Ä–µ–ø–∫–∞ (üìå).
        *   **–î–µ–π—Å—Ç–≤–∏–µ**: `ChatService/PinBot(botId)` / `UnpinBot`.
        *   **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Drag & Drop)**: `ChatService/ReorderPinnedBots`.
    3.  **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**:
        *   `Status`: Typing... (—á–µ—Ä–µ–∑ Stream `SubscribeToEvents`).
        *   `Unread`: –ö–∞—É–Ω—Ç–µ—Ä—ã –∏–∑ `ChatThread`.

### –ë–ª–æ–∫: –û–∫–Ω–æ –ß–∞—Ç–∞ (Messages Area)
* **API –ú–µ—Ç–æ–¥**: `ChatService/GetHistory(threadId, filter=ALL|FAVORITES)`.
* **–ú–æ–¥–µ–ª—å**: `Message`.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
    1.  **–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –°–æ–æ–±—â–µ–Ω–∏—è (Favorites)**:
        *   **–î–µ–π—Å—Ç–≤–∏–µ**: –ö–ª–∏–∫ –Ω–∞ `Star` (‚≠ê) —É —Å–æ–æ–±—â–µ–Ω–∏—è -> `ChatService/AddToFavorites` / `RemoveFromFavorites`.
        *   **–ü–æ–∏—Å–∫/–§–∏–ª—å—Ç—Ä**: –¢–æ–≥–≥–ª "Favorites Only" -> –∑–∞–ø—Ä–æ—Å —Å —Ñ–∏–ª—å—Ç—Ä–æ–º.
    2.  **–ö–æ–Ω—Ç–µ–Ω—Ç**:
        *   –¢–µ–∫—Å—Ç (Markdown), –ê—É–¥–∏–æ (–ø–ª–µ–µ—Ä + —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è).
        *   **Sinking Mode**: –ê–Ω–∏–º–∞—Ü–∏—è "Thinking..." (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ).
    3.  **–°—Ç—Ä–∏–º —Å–æ–±—ã—Ç–∏–π**:
        *   –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Ç–∞–π–ø–∏–Ω–≥ –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `SubscribeToEvents`.

### –ë–ª–æ–∫: Input (–í–≤–æ–¥)
* **API**: `ChatService/SendMessage`.
* **Modes**: Text / Voice.

### –ë–ª–æ–∫: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ß–∞—Ç–∞ (Chat Header Widgets)
* **–†–µ–∂–∏–º –û—Ç–≤–µ—Ç–∞**:
    *   **API**: `UpdateChatConfiguration({ response_mode: VOICE })`.
    *   –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–∫—Å—Ç/–≥–æ–ª–æ—Å.
* **Thinking Mode**:
    *   **API**: `UpdateChatConfiguration({ sinking_mode_enabled: true })`.
    *   –í–∫–ª—é—á–∞–µ—Ç "–≥–ª—É–±–æ–∫–æ–µ –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ" –æ–±–¥—É–º—ã–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤.

### –ë–ª–æ–∫: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ú–µ–Ω—é (Chat Actions)
* **–õ–æ–∫–∞—Ü–∏—è**: –•–µ–¥–µ—Ä —á–∞—Ç–∞.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
    1.  **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å**:
        *   **API**: `UpdateChatTitle(threadId, title)`.
    2.  **–£–¥–∞–ª–∏—Ç—å**:
        *   **API**: `DeleteChat(threadId)`.
        *   –£–¥–∞–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.
